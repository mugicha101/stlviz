r should be assigned to r not r-1